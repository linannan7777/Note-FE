## **1、** 版本控制工具应该具备的功能 

-   协同修改
    多人并行不悖的修改服务器端的同一个文件。 

-   数据备份
    不仅保存目录和文件的当前状态，还能够保存每一个提交过的历史状态。 

-   版本管理
    在保存每一个版本的文件信息的时候要做到不保存重复数据，以节约存储空间，提高运行效率。这方面 SVN 采用的是增量式管理的方式，而 Git 采取了文件系统快照的方式。 

-   权限控制 

   对团队中参与开发的人员进行权限控制。 

   对团队外开发者贡献的代码进行审核——Git独有。 

-   历史记录 

   查看修改人、修改时间、修改内容、日志信息。 

   将本地文件恢复到某一个历史状态。 

-   分支管理 

   允许开发团队在工作过程中多条生产线同时推进任务，进一步提高效率。 

## **2** 版本控制简介 

### **2.1** 版本控制

 工程设计领域中使用版本控制管理工程蓝图的设计过程。在 IT 开发过程中也可以使用版本控制思想管理代码的版本迭代。

### **2.2** 版本控制工具

 	思想:版本控制 

​	实现:版本控制工具

集中式版本控制工具:

CVS、**SVN**、VSS...... 

分布式版本控制工具:
**Git**、Mercurial、Bazaar、Darcs......

### **2.3 Git** 的优势

 大部分操作在本地完成，不需要联网
 完整性保证
 尽可能添加数据而不是删除或修改数据
 分支操作非常快捷流畅
 与Linux命令全面兼容

### **2.4 Git的结构** 

- 工作区
- 暂存区
- 本地库
- 远程库

## 3、 git命令

#### 配置

Git自带一个git config的工具来帮助设置控制Git外观和行为的配置变量。这些变量存储在三个不同的位置: 

1. /etc/gitconfig 文件: 包含系统上每一个用户及他们仓库的通用配置。 如果使用带有 --system 选项的 git config时，它会从此文件读写配置变量。 
2.  ~/.gitconfig 或 ~/.config/git/config 文件:只针对当前用户。 可以传递 --global 选项让 Git 读写此文件。 
3. 当前使用仓库的 Git 目录中的 config 文件(就是 .git/config):针对该仓库。 

每一个级别覆盖上一级别的配置

#### 检查配置信息

```
git config --list
```

你可以通过输入git config <key>:来检查Git的某一项配置

 ```
git config user.name
 ```

#### 设置签名：

1. 项目级别/仓库级别:仅在当前本地库范围内有效：

   ```
   git config user.name tom
   git config user.email tom@qq.com
   ```

   信息保存位置:./.git/config 文件 

2.  系统用户级别:登录当前操作系统的用户范围

   ```
   git config --global user.name tom
   git config --global tom@qq.com
   ```

   信息保存位置:~/.gitconfig 文件

作用:区分不同开发人员的身份。这里设置的签名和登录远程库(代码托管中心)的账号、密码没有任何关 

系。 

级别优先级 

-   就近原则:项目级别优先于系统用户级别，二者都有时采用项目级别的签名 
-   如果只有系统用户级别的签名，就以系统用户级别的签名为准 
-   二者都没有不允许 

#### 获取帮助

 若你使用 Git 时需要获取帮助，有三种方法可以找到 Git 命令的使用手册: 

```
git help <verb>
git <verb> --help
man git-<verb>
```

例如，要想获得 config 命令的手册，执行 

```
 git help config
```

#### 在现有目录中初始化仓库

```
git init
```

该命令将创建一个名为 .git 的子目录，这个子目录含有你初始化的 Git 仓库中所有的必须文件，这些文件是
Git 仓库的骨干。

#### 状态查看 ：

git status    查看工作区和暂存区状态

#### 添加

git add [file name]   将工作区指定文件的“新建/修改”添加到暂存区

git add .         添加所有改动至暂存区

#### 提交

git commit -m "commit message" [file name]        将暂存区的内容提交到本地库

#### 查看历史记录

git log      多屏显示控制方式: 空格向下翻页  b 向上翻页 q退出 

git log --pretty=oneline

git log --oneline

git reflog

#### 前进后退

- 基于索引值操作[推荐]
   git reset --hard [局部索引值]
   git reset --hard a6ace91

- 使用^符号:只能后退
    git reset --hard HEAD^
    注:一个^表示后退一步，n个表示后退n步 
-   使用~符号:只能后退
    git reset --hard HEAD~n  注:表示后退n步 

#### **reset** 命令的三个参数对比

- --soft参数  仅移动本地库HEAD指针
- --mixed参数  在本地库移动HEAD指针，并重置暂存区
- —hard参数 在本地库移动HEAD指针，并重置暂存区和工作区

#### 删除文件并找回

- 前提:删除前，文件存在时的状态提交到了本地库。 

-   操作:git reset --hard [指针位置] 

   删除操作已经提交到本地库:指针位置指向历史记录  删除操作尚未提交到本地库:指针位置使用HEAD 

#### 比较文件差异 

- git diff [文件名] 

   将工作区中的文件和暂存区进行比较 

-   git diff [本地库中历史版本] [文件名] 

   将工作区中的文件和本地库历史记录比较 

-   不带文件名比较多个文件 

### 创建远程库地址别名

git remote -v 查看当前所有远程地址别名
git remote add [别名] [远程地址]

### 拉取 

-    pull=fetch+merge 
-    git fetch [远程库地址别名] [远程分支名] 
-    git merge [远程库地址别名/远程分支名] 
-    git pull [远程库地址别名] [远程分支名] 

### 推送

git push [别名] [分支名]

### 克隆

git clone [url]

## 分支

### 分支的好处：

- 同时并行推进多个功能开发，提高开发效率 
- 各个分支在开发过程中，如果某一个分支开发失败，不会对其他分支有任何影响。失败的分支删除重新开始即可。

### 分支操作 

- 创建分支 
git branch [分支名] 

-  查看分支 
git branch -v 

- 切换分支
  git checkout [分支名] 

-  合并分支
  
  1. 切换到接受修改的分支(被合并，增加新内容)上 
     git checkout [被合并分支名]
  
  2. 执行merge命令
     git merge [有新内容分支名]
  3. 解决冲突
     - 第一步:编辑文件，删除特殊符号 
     - 第二步:把文件修改到满意的程度，保存退出 
     - 第三步:git add [文件名] 
     - 第四步:git commit -m "日志信息"               注意:此时commit一定不能带具体文件名 
  
  #### 分支种类
  
  - 主干分支 master 
    主要负责管理正在运行的生产环境代码。永远保持与正在运行的生产环境 完全一致。 
  
  - 开发分支 develop 
    主要负责管理正在开发过程中的代码。一般情况下应该是最新的代码。 
  
  - bug 修理分支 hotfix
     主要负责管理生产环境下出现的紧急修复的代码。从主干分支分出，修理完毕并测试上线后，并回主干分支。并回后，视情况可以删除该分支。   

  - 准生产分支(预发布分支) release 
    较大的版本上线前，会从开发分支中分出准生产分支，进行最后阶段的集 成测试。该版本上线后，会合并到主干分支。生产环境运行一段阶段较稳定后 可以视情况删除。 
  
  - 功能分支 feature 
    为了不影响较短周期的开发工作，一般把中长期开发模块，会从开发分支中独立出来。 开发完成后会合并到开发分支。 

## Git 基本原理

Git 底层采用的是 SHA-1 算法,哈希算法可以被用来验证文件是否被更改过。

### Git 保存版本的机制

集中式版本控制工具的文件管理机制是以文件变更列表的方式存储信息。这类系统将它们保存的信息看作是一组基本文件和每个文件随时间逐步累积的差异。

Git 把数据看作是小型文件系统的一组快照。每次提交更新时 Git 都会对当前的全部文件制作一个快照并保存这个快照的索引。为了高效，如果文件没有修改， Git 不再重新存储该文件，而是只保留一个链接指向之前存储的文件。所以 Git 的工作方式可以称之为快照流。 